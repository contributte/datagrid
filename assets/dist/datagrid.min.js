var datagridFitlerMultiSelect,datagridSortable,datagridSortableTree;$(document).on("click","[data-datagrid-confirm]",function(t){return confirm($(t.target).closest("a").attr("data-datagrid-confirm"))?void 0:(t.stopPropagation(),t.preventDefault())}),$.nette.ext("datagrid.confirm",{before:function(t,e){var a;return e.nette&&(a=e.nette.el.data("datagrid-confirm"))?confirm(a):void 0}}),$(document).on("change","select[data-autosubmit-per-page]",function(){return $(this).parent().find("input[type=submit]").click()}).on("change","select[data-autosubmit]",function(){return $(this).closest("form").submit()}).on("change","input[data-autosubmit][data-autosubmit-change]",function(t){var e,a;return a=t.which||t.keyCode||0,clearTimeout(window.datagrid_autosubmit_timer),e=$(this),window.datagrid_autosubmit_timer=setTimeout(function(t){return function(){return e.closest("form").submit()}}(this),200)}).on("keyup","input[data-autosubmit]",function(t){var e,a;return a=t.which||t.keyCode||0,13!==a&&(a>=9&&40>=a||a>=112&&123>=a)?void 0:(clearTimeout(window.datagrid_autosubmit_timer),e=$(this),window.datagrid_autosubmit_timer=setTimeout(function(t){return function(){return e.closest("form").submit()}}(this),200))}).on("keydown",".datagrid-inline-edit input",function(t){var e;return e=t.which||t.keyCode||0,13===e?(t.stopPropagation(),t.preventDefault(),$(this).closest("tr").find('.col-action-inline-edit [name="inline_edit[submit]"]').click()):void 0}),$(document).on("keydown","input[data-datagrid-manualsubmit]",function(t){var e;return e=t.which||t.keyCode||0,13===e?(t.stopPropagation(),t.preventDefault(),$(this).closest("form").submit()):void 0}),document.addEventListener("change",function(t){var e,a,i,d,n,r,o,l,s,c;if(i=t.target.getAttribute("data-check"),i&&(e=document.querySelector(".datagrid-"+i+" input[data-check]:checked"),c=document.querySelector(".datagrid-"+i+' select[name="group_action[group_action]"]'),c&&(e?c.disabled=!1:(c.disabled=!0,c.value="")),n=window.navigator.userAgent.indexOf("MSIE "),n?(a=document.createEvent("Event"),a.initEvent("change",!0,!0)):a=new Event("change",{bubbles:!0}),c&&c.dispatchEvent(a)),i=t.target.getAttribute("data-check-all")){for(o=document.querySelectorAll("input[type=checkbox][data-check-all-"+i+"]"),s=[],d=0,l=o.length;l>d;d++)r=o[d],r.checked=t.target.checked,n=window.navigator.userAgent.indexOf("MSIE "),n?(a=document.createEvent("Event"),a.initEvent("change",!0,!0)):a=new Event("change",{bubbles:!0}),s.push(r.dispatchEvent(a));return s}}),window.datagridSerializeUrl=function(t,e){var a=[];for(var i in t)if(t.hasOwnProperty(i)){var d=e?e+"["+i+"]":i,n=t[i];null!==n&&""!==n&&a.push("object"==typeof n?window.datagridSerializeUrl(n,d):encodeURIComponent(d)+"="+encodeURIComponent(n))}return a.join("&")},datagridSortable=function(){return"undefined"!=typeof $.fn.sortable?$(".datagrid [data-sortable]").sortable({handle:".handle-sort",items:"tr",axis:"y",update:function(t,e){var a,i,d,n,r;return n=e.item.closest("tr[data-id]"),a=n.data("id"),d=null,i=null,n.prev().length&&(d=n.prev().data("id")),n.next().length&&(i=n.next().data("id")),r=$(this).data("sortable-url"),$.nette.ajax({type:"GET",url:r,data:{item_id:a,prev_id:d,next_id:i},error:function(t,e,a){return alert(t.statusText)}})},helper:function(t,e){return e.children().each(function(){return $(this).width($(this).width())}),e}}):void 0},$(function(){return datagridSortable()}),"undefined"==typeof datagridSortableTree&&(datagridSortableTree=function(){return"undefined"!=typeof $(".datagrid-tree-item-children").sortable?$(".datagrid-tree-item-children").sortable({handle:".handle-sort",items:".datagrid-tree-item",toleranceElement:"> .datagrid-tree-item-content",connectWith:".datagrid-tree-item-children",update:function(t,e){var a,i,d,n,r,o,l;return $(".toggle-tree-to-delete").remove(),o=e.item.closest(".datagrid-tree-item[data-id]"),a=o.data("id"),r=null,i=null,n=null,o.prev().length&&(r=o.prev().data("id")),o.next().length&&(i=o.next().data("id")),d=o.parent().closest(".datagrid-tree-item"),d.length&&(d.find(".datagrid-tree-item-children").first().css({display:"block"}),d.addClass("has-children"),n=d.data("id")),(l=$(this).data("sortable-url"))?(d.find("[data-toggle-tree]").first().removeClass("hidden"),$.nette.ajax({type:"GET",url:l,data:{item_id:a,prev_id:r,next_id:i,parent_id:n},error:function(t,e,a){return"abort"!==a?alert(t.statusText):void 0}})):void 0},stop:function(t,e){return $(".toggle-tree-to-delete").removeClass("toggle-tree-to-delete")},start:function(t,e){var a;return a=e.item.parent().closest(".datagrid-tree-item"),a.length&&2===a.find(".datagrid-tree-item").length?a.find("[data-toggle-tree]").addClass("toggle-tree-to-delete"):void 0}}):void 0}),$(function(){return datagridSortableTree()}),$.nette.ext("datagrid.happy",{success:function(){var t,e,a,i,d,n,r,o,l,s,c,u,g,f;for(window.happy&&window.happy.reset(),r=$(".datagrid"),f=[],o=0,u=r.length;u>o;o++){for(n=r[o],i=n.classList,a="",c=0,g=i.length;g>c;c++)t=i[c],a=a+"."+t;e=document.querySelectorAll(a+" input[data-check]:checked"),1===e.length&&"toggle-all"===e[0].getAttribute("name")?(s=document.querySelector(a+" input[name=toggle-all]"),s?(s.checked=!1,l=window.navigator.userAgent.indexOf("MSIE "),l?(d=document.createEvent("Event"),d.initEvent("change",!0,!0)):d=new Event("change",{bubbles:!0}),f.push(s.dispatchEvent(d))):f.push(void 0)):f.push(void 0)}return f}}),$.nette.ext("datagrid.sortable",{success:function(){return datagridSortable()}}),$.nette.ext("datagrid.forms",{success:function(){return $(".datagrid").find("form").each(function(){return window.Nette.initForm(this)})}}),$.nette.ext("datagrid.url",{success:function(t){var e,a,i,d;return t._datagrid_url&&window.history.pushState&&(e=window.location.protocol+"//"+window.location.host,a=window.location.pathname,i=window.datagridSerializeUrl(t.state).replace(/&+$/gm,""),d=i?e+a+"?"+i.replace(/\&*$/,""):e+a,d+=window.location.hash,window.location.href!==d)?window.history.pushState({path:d},"",d):void 0}}),$.nette.ext("datagrid.sort",{success:function(t){var e,a,i,d;if(t._datagrid_sort){i=t._datagrid_sort,d=[];for(a in i)e=i[a],d.push($("#datagrid-sort-"+a).attr("href",e));return d}}}),$.nette.ext("datargid.item_detail",{before:function(t,e){var a,i;return e.nette&&e.nette.el.attr("data-toggle-detail")?(a=e.nette.el.attr("data-toggle-detail"),i=$(".item-detail-"+a),i.hasClass("loaded")?i.find(".item-detail-content").size()?(i.hasClass("toggled")?i.find(".item-detail-content").slideToggle("fast",function(t){return function(){return i.toggleClass("toggled")}}(this)):(i.toggleClass("toggled"),i.find(".item-detail-content").slideToggle("fast")),!1):(i.removeClass("toggled"),!0):i.addClass("loaded")):void 0},success:function(t){var e,a;return t._datagrid_toggle_detail?(e=t._datagrid_toggle_detail,a=$(".item-detail-"+e),a.toggleClass("toggled"),a.find(".item-detail-content").slideToggle("fast")):void 0}}),$.nette.ext("datagrid.tree",{before:function(t,e){var a;return e.nette&&e.nette.el.attr("data-toggle-tree")&&(e.nette.el.toggleClass("toggle-rotate"),a=e.nette.el.closest(".datagrid-tree-item").find(".datagrid-tree-item-children").first(),a.hasClass("loaded"))?(a.slideToggle("fast"),!1):!0},success:function(t){var e,a,i,d,n,r,o;if(t._datagrid_tree){i=t._datagrid_tree,e=$(".datagrid-tree-item[data-id="+i+"]").find(".datagrid-tree-item-children").first(),e.addClass("loaded"),n=t.snippets;for(d in n)r=n[d],a=$(r),o=$('<div class="datagrid-tree-item" id="'+d+'">'),o.attr("data-id",a.attr("data-id")),o.append(a),a.data("has-children")&&o.addClass("has-children"),e.append(o);e.addClass("loaded"),e.slideToggle("fast"),$.nette.load()}return datagridSortableTree()}}),$(document).on("click","[data-datagrid-editable-url]",function(t){var e,a,i,d,n,r,o,l,s,c,u;if(d=$(this),!d.hasClass("datagrid-inline-edit")&&!d.hasClass("editing")){d.addClass("editing"),u=d.html().trim().replace("<br>","\n"),d.data("value",u),"textarea"===d.data("datagrid-editable-type")?(l=$("<textarea>"+u+"</textarea>"),o=parseInt(d.css("padding").replace(/[^-\d\.]/g,""),10),n=d.outerHeight(),s=Math.round(parseFloat(d.css("line-height"))),r=(n-2*o)/s,l.attr("rows",Math.round(r))):"select"===d.data("datagrid-editable-type")?(l=$(d.data("datagrid-editable-element")),l.find("option").each(function(){return $(this).text()===u?l.find("option[value="+$(this).val()+"]").prop("selected",!0):void 0})):(l=$('<input type="'+d.data("datagrid-editable-type")+'">'),l.val(u)),i=d.data("datagrid-editable-attrs");for(e in i)a=i[e],l.attr(e,a);return d.removeClass("edited"),d.html(l),c=function(t,e){return u=e.val(),u!==t.data("value")&&$.nette.ajax({url:t.data("datagrid-editable-url"),data:{value:u},method:"POST"}).success(function(){return t.addClass("edited")}),t.removeClass("editing"),t.html(u)},d.find("input,textarea,select").focus().on("blur",function(){return c(d,$(this))}).on("keydown",function(t){return"textarea"!==d.data("datagrid-editable-type")&&13===t.which?(t.stopPropagation(),t.preventDefault(),c(d,$(this))):void 0}),d.find("select").on("change",function(){return c(d,$(this))})}}),$.nette.ext("datagrid.after_inline_edit",{success:function(t){return t._datagrid_inline_edited?($("tr[data-id="+t._datagrid_inline_edited+"] > td").addClass("edited"),$(".datagrid-inline-edit-trigger").removeClass("hidden")):t._datagrid_inline_edit_cancel?$(".datagrid-inline-edit-trigger").removeClass("hidden"):void 0}}),$(document).on("click","[data-datagrid-toggle-inline-add]",function(t){var e;return t.stopPropagation(),t.preventDefault(),e=$(this).closest(".datagrid").find(".datagrid-row-inline-add"),e.hasClass("datagrid-row-inline-add-hidden")&&e.removeClass("datagrid-row-inline-add-hidden"),e.find("input:not([readonly]),textarea:not([readonly])").first().focus()}),$(document).on("mousedown","[data-datagrid-cancel-inline-add]",function(t){return t.stopPropagation(),t.preventDefault(),$(".datagrid-row-inline-add").addClass("datagrid-row-inline-add-hidden")}),$.nette.ext("datagrid-toggle-inline-add",{success:function(t){return t._datagrid_inline_added?($(".datagrid-row-inline-add").find("textarea").html(""),$(".datagrid-row-inline-add").find("input[type!=submit]").val(""),$(".datagrid-row-inline-add").addClass("datagrid-row-inline-add-hidden")):void 0}}),datagridFitlerMultiSelect=function(){var t;return t=$(".selectpicker").first(),$.fn.selectpicker?$.fn.selectpicker.defaults={countSelectedText:t.data("i18n-selected"),iconBase:"",tickIcon:t.data("selected-icon-check")}:void 0},$(function(){return datagridFitlerMultiSelect()}),$.nette.ext("datagrid.fitlerMultiSelect",{success:function(){return datagridFitlerMultiSelect(),$.fn.selectpicker?$(".selectpicker").selectpicker():void 0}}),$.nette.ext("datagrid.inline-editing",{success:function(t){return t._datagrid_inline_editing?$(".datagrid-inline-edit-trigger").addClass("hidden"):void 0}}),$.nette.ext("datagrid.redraw-item",{success:function(t){var e;return t._datagrid_redraw_item_class?(e=$("tr[data-id="+t._datagrid_redraw_item_id+"]"),e.attr("class",t._datagrid_redraw_item_class)):void 0}});