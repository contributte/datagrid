var datagridFitlerMultiSelect,datagridGroupActionMultiSelect,datagridShiftGroupSelection,datagridSortable,datagridSortableTree;$(document).on("click","[data-datagrid-confirm]:not(.ajax)",function(a){if(!confirm($(a.target).closest("a").attr("data-datagrid-confirm"))){a.stopPropagation();return a.preventDefault()}});$.nette.ext("datagrid.confirm",{before:function(c,b){var a;if(b.nette){a=b.nette.el.data("datagrid-confirm");if(a){return confirm(a)}}}});$(document).on("change","select[data-autosubmit-per-page]",function(){var a;a=$(this).parent().find("input[type=submit]");if(a.length===0){a=$(this).parent().find("button[type=submit]")}return a.click()}).on("change","select[data-autosubmit]",function(){return $(this).closest("form").first().submit()}).on("change","input[data-autosubmit][data-autosubmit-change]",function(c){var b,a;a=c.which||c.keyCode||0;clearTimeout(window.datagrid_autosubmit_timer);b=$(this);return window.datagrid_autosubmit_timer=setTimeout((function(d){return function(){return b.closest("form").first().submit()}})(this),200)}).on("keyup","input[data-autosubmit]",function(c){var b,a;a=c.which||c.keyCode||0;if((a!==13)&&((a>=9&&a<=40)||(a>=112&&a<=123))){return}clearTimeout(window.datagrid_autosubmit_timer);b=$(this);return window.datagrid_autosubmit_timer=setTimeout((function(d){return function(){return b.closest("form").first().submit()}})(this),200)}).on("keydown",".datagrid-inline-edit input",function(b){var a;a=b.which||b.keyCode||0;if(a===13){b.stopPropagation();b.preventDefault();return $(this).closest("tr").find('.col-action-inline-edit [name="inline_edit[submit]"]').click()}});$(document).on("keydown","input[data-datagrid-manualsubmit]",function(b){var a;a=b.which||b.keyCode||0;if(a===13){b.stopPropagation();b.preventDefault();return $(this).closest("form").first().submit()}});datagridShiftGroupSelection=function(){var a;a=null;return document.addEventListener("click",function(y){var q,m,b,v,w,r,o,u,t,c,h,x,l,g,d,p,s,f,n;d=y.path;for(w=0,x=d.length;w<x;w++){b=d[w];if($(b).is(".col-checkbox")&&a&&y.shiftKey){m=$(b).closest("tr");c=a.closest("tr");h=c.closest("tbody");q=h.find("tr").toArray();if(m.index()>c.index()){n=q.slice(c.index(),m.index())}else{if(m.index()<c.index()){n=q.slice(m.index()+1,c.index())}}if(!n){return}for(u=0,l=n.length;u<l;u++){f=n[u];o=$(f).find(".col-checkbox input[type=checkbox]")[0];if(o){o.checked=true;r=window.navigator.userAgent.indexOf("MSIE ");if(r){v=document.createEvent("Event");v.initEvent("change",true,true)}else{v=new Event("change",{bubbles:true})}o.dispatchEvent(v)}}}}p=y.path;s=[];for(t=0,g=p.length;t<g;t++){b=p[t];if($(b).is(".col-checkbox")){s.push(a=$(b))}else{s.push(void 0)}}return s})};datagridShiftGroupSelection();document.addEventListener("change",function(k){var j,c,a,f,b,m,g,h,d,l;a=k.target.getAttribute("data-check");if(a){j=document.querySelector(".datagrid-"+a+" input[data-check]:checked");l=document.querySelector(".datagrid-"+a+' select[name="group_action[group_action]"]');if(l){if(j){l.disabled=false}else{l.disabled=true;l.value=""}}b=window.navigator.userAgent.indexOf("MSIE ");if(b){c=document.createEvent("Event");c.initEvent("change",true,true)}else{c=new Event("change",{bubbles:true})}if(l){l.dispatchEvent(c)}}a=k.target.getAttribute("data-check-all");if(a){g=document.querySelectorAll("input[type=checkbox][data-check-all-"+a+"]");d=[];for(f=0,h=g.length;f<h;f++){m=g[f];m.checked=k.target.checked;b=window.navigator.userAgent.indexOf("MSIE ");if(b){c=document.createEvent("Event");c.initEvent("change",true,true)}else{c=new Event("change",{bubbles:true})}d.push(m.dispatchEvent(c))}return d}});window.datagridSerializeUrl=function(f,d){var g=[];for(var e in f){if(f.hasOwnProperty(e)){var b=d?d+"["+e+"]":e,a=f[e];if(a!==null&&a!==""){if(typeof a=="object"){var c=window.datagridSerializeUrl(a,b);if(c){g.push(c)}}else{g.push(encodeURIComponent(b)+"="+encodeURIComponent(a))}}}}return g.join("&")};datagridSortable=function(){if(typeof $.fn.sortable==="undefined"){return}return $(".datagrid [data-sortable]").sortable({handle:".handle-sort",items:"tr",axis:"y",update:function(b,f){var d,c,i,e,g,h,a;h=f.item.closest("tr[data-id]");i=h.data("id");g=null;e=null;if(h.prev().length){g=h.prev().data("id")}if(h.next().length){e=h.next().data("id")}a=$(this).data("sortable-url");c={};d=h.closest(".datagrid").find("tbody").attr("data-sortable-parent-path");c[(d+"-item_id").replace(/^-/,"")]=i;c[(d+"-prev_id").replace(/^-/,"")]=g;c[(d+"-next_id").replace(/^-/,"")]=e;return $.nette.ajax({type:"GET",url:a,data:c,error:function(j,l,k){return alert(j.statusText)}})},helper:function(b,a){a.children().each(function(){return $(this).width($(this).width())});return a}})};$(function(){return datagridSortable()});if(typeof datagridSortableTree==="undefined"){datagridSortableTree=function(){if(typeof $(".datagrid-tree-item-children").sortable==="undefined"){return}return $(".datagrid-tree-item-children").sortable({handle:".handle-sort",items:".datagrid-tree-item:not(.datagrid-tree-header)",toleranceElement:"> .datagrid-tree-item-content",connectWith:".datagrid-tree-item-children",update:function(b,g){var d,c,k,e,h,f,i,j,a;$(".toggle-tree-to-delete").remove();j=g.item.closest(".datagrid-tree-item[data-id]");k=j.data("id");i=null;e=null;f=null;if(j.prev().length){i=j.prev().data("id")}if(j.next().length){e=j.next().data("id")}h=j.parent().closest(".datagrid-tree-item");if(h.length){h.find(".datagrid-tree-item-children").first().css({display:"block"});h.addClass("has-children");f=h.data("id")}a=$(this).data("sortable-url");if(!a){return}h.find("[data-toggle-tree]").first().removeClass("hidden");d=j.closest(".datagrid-tree").attr("data-sortable-parent-path");c={};c[(d+"-item_id").replace(/^-/,"")]=k;c[(d+"-prev_id").replace(/^-/,"")]=i;c[(d+"-next_id").replace(/^-/,"")]=e;c[(d+"-parent_id").replace(/^-/,"")]=f;return $.nette.ajax({type:"GET",url:a,data:c,error:function(l,n,m){if(m!=="abort"){return alert(l.statusText)}}})},stop:function(a,b){return $(".toggle-tree-to-delete").removeClass("toggle-tree-to-delete")},start:function(b,c){var a;a=c.item.parent().closest(".datagrid-tree-item");if(a.length){if(a.find(".datagrid-tree-item").length===2){return a.find("[data-toggle-tree]").addClass("toggle-tree-to-delete")}}}})}}$(function(){return datagridSortableTree()});$.nette.ext("datagrid.happy",{success:function(){var o,q,n,e,d,a,f,l,b,p,h,m,g,k;if(window.happy){window.happy.reset()}f=$(".datagrid");k=[];for(l=0,m=f.length;l<m;l++){a=f[l];e=a.classList;n="";for(h=0,g=e.length;h<g;h++){o=e[h];n=n+"."+o}q=document.querySelectorAll(n+" input[data-check]:checked");if(q.length===1&&q[0].getAttribute("name")==="toggle-all"){p=document.querySelector(n+" input[name=toggle-all]");if(p){p.checked=false;b=window.navigator.userAgent.indexOf("MSIE ");if(b){d=document.createEvent("Event");d.initEvent("change",true,true)}else{d=new Event("change",{bubbles:true})}k.push(p.dispatchEvent(d))}else{k.push(void 0)}}else{k.push(void 0)}}return k}});$.nette.ext("datagrid.sortable",{success:function(){return datagridSortable()}});$.nette.ext("datagrid.forms",{success:function(){return $(".datagrid").find("form").each(function(){return window.Nette.initForm(this)})}});$.nette.ext("datagrid.url",{success:function(e){var b,d,c,a;if(e._datagrid_url){if(window.history.pushState){b=window.location.protocol+"//"+window.location.host;d=window.location.pathname;c=window.datagridSerializeUrl(e.state).replace(/&+$/gm,"");if(c){a=b+d+"?"+c.replace(/\&*$/,"")}else{a=b+d}a+=window.location.hash;if(window.location.href!==a){return window.history.pushState({path:a},"",a)}}}}});$.nette.ext("datagrid.sort",{success:function(e){var a,c,d,b;if(e._datagrid_sort){d=e._datagrid_sort;b=[];for(c in d){a=d[c];b.push($("#datagrid-sort-"+c).attr("href",a))}return b}}});$.nette.ext("datargid.item_detail",{before:function(c,b){var d,a;if(b.nette&&b.nette.el.attr("data-toggle-detail")){d=b.nette.el.attr("data-toggle-detail");a=$(".item-detail-"+d);if(a.hasClass("loaded")){if(!a.find(".item-detail-content").size()){a.removeClass("toggled");return true}if(a.hasClass("toggled")){a.find(".item-detail-content").slideToggle("fast",(function(e){return function(){return a.toggleClass("toggled")}})(this))}else{a.toggleClass("toggled");a.find(".item-detail-content").slideToggle("fast")}return false}else{return a.addClass("loaded")}}},success:function(b){var c,a;if(b._datagrid_toggle_detail){c=b._datagrid_toggle_detail;a=$(".item-detail-"+c);a.toggleClass("toggled");return a.find(".item-detail-content").slideToggle("fast")}}});$.nette.ext("datagrid.tree",{before:function(b,a){var c;if(a.nette&&a.nette.el.attr("data-toggle-tree")){a.nette.el.toggleClass("toggle-rotate");c=a.nette.el.closest(".datagrid-tree-item").find(".datagrid-tree-item-children").first();if(c.hasClass("loaded")){c.slideToggle("fast");return false}}return true},success:function(f){var h,e,g,a,d,c,b;if(f._datagrid_tree){g=f._datagrid_tree;h=$('.datagrid-tree-item[data-id="'+g+'"]').find(".datagrid-tree-item-children").first();h.addClass("loaded");d=f.snippets;for(a in d){c=d[a];e=$(c);b=$('<div class="datagrid-tree-item" id="'+a+'">');b.attr("data-id",e.attr("data-id"));b.append(e);if(e.data("has-children")){b.addClass("has-children")}h.append(b)}h.addClass("loaded");h.slideToggle("fast");$.nette.load()}return datagridSortableTree()}});$(document).on("click","[data-datagrid-editable-url]",function(a){var l,c,j,k,d,f,b,g,i,e,h;k=$(this);if(k.hasClass("datagrid-inline-edit")){return}if(!k.hasClass("editing")){k.addClass("editing");h=k.html().trim().replace("<br>","\n");k.data("value",h);if(k.data("datagrid-editable-type")==="textarea"){g=$("<textarea>"+h+"</textarea>");b=parseInt(k.css("padding").replace(/[^-\d\.]/g,""),10);d=k.outerHeight();i=Math.round(parseFloat(k.css("line-height")));f=(d-(2*b))/i;g.attr("rows",Math.round(f))}else{if(k.data("datagrid-editable-type")==="select"){g=$(k.data("datagrid-editable-element"));g.find("option").each(function(){if($(this).text()===h){return g.find("option[value="+$(this).val()+"]").prop("selected",true)}})}else{g=$('<input type="'+k.data("datagrid-editable-type")+'">');g.val(h)}}j=k.data("datagrid-editable-attrs");for(l in j){c=j[l];g.attr(l,c)}k.removeClass("edited");k.html(g);e=function(m,n){h=n.val();if(h!==m.data("value")){$.nette.ajax({url:m.data("datagrid-editable-url"),data:{value:h},method:"POST",success:function(){if(m.data("datagrid-editable-type")==="select"){m.html(g.find("option[value="+h+"]").html())}else{m.html(h)}return m.addClass("edited")},error:function(){m.html(m.data("value"));return m.addClass("edited-error")}})}else{m.html(m.data("value"))}return setTimeout(function(){return m.removeClass("editing")},1200)};k.find("input,textarea,select").focus().on("blur",function(){return e(k,$(this))}).on("keydown",function(m){if(k.data("datagrid-editable-type")!=="textarea"){if(m.which===13){m.stopPropagation();m.preventDefault();return e(k,$(this))}}if(m.which===27){m.stopPropagation();m.preventDefault();k.removeClass("editing");return k.html(k.data("value"))}});return k.find("select").on("change",function(){return e(k,$(this))})}});$.nette.ext("datagrid.after_inline_edit",{success:function(b){var a;a=$(".datagrid-"+b._datagrid_name);if(b._datagrid_inline_edited){a.find("tr[data-id="+b._datagrid_inline_edited+"] > td").addClass("edited");return a.find(".datagrid-inline-edit-trigger").removeClass("hidden")}else{if(b._datagrid_inline_edit_cancel){return a.find(".datagrid-inline-edit-trigger").removeClass("hidden")}}}});$(document).on("click","[data-datagrid-toggle-inline-add]",function(a){var b;a.stopPropagation();a.preventDefault();b=$(this).closest(".datagrid").find(".datagrid-row-inline-add");if(b.hasClass("datagrid-row-inline-add-hidden")){b.removeClass("datagrid-row-inline-add-hidden")}return b.find("input:not([readonly]),textarea:not([readonly])").first().focus()});$(document).on("mousedown","[data-datagrid-cancel-inline-add]",function(a){a.stopPropagation();a.preventDefault();return $(".datagrid-row-inline-add").addClass("datagrid-row-inline-add-hidden")});$.nette.ext("datagrid-toggle-inline-add",{success:function(a){if(a._datagrid_inline_added){$(".datagrid-row-inline-add").find("textarea").html("");$(".datagrid-row-inline-add").find("input[type!=submit]").val("");return $(".datagrid-row-inline-add").addClass("datagrid-row-inline-add-hidden")}}});datagridFitlerMultiSelect=function(){var a;a=$(".selectpicker").first();if($.fn.selectpicker){return $.fn.selectpicker.defaults={countSelectedText:a.data("i18n-selected"),iconBase:"",tickIcon:a.data("selected-icon-check")}}};$(function(){return datagridFitlerMultiSelect()});datagridGroupActionMultiSelect=function(){var a;a=$("[data-datagrid-multiselect-id]");return a.each(function(){var b;if($(this).hasClass("selectpicker")){$(this).removeAttr("id");b=$(this).data("datagrid-multiselect-id");return $(this).on("loaded.bs.select",function(c){$(this).parent().attr("style","display:none;");$(this).parent().attr("id",b);return $(this).parent().find(".hidden").removeClass("hidden").addClass("btn-default")})}})};$(function(){return datagridGroupActionMultiSelect()});$.nette.ext("datagrid.fitlerMultiSelect",{success:function(){datagridFitlerMultiSelect();if($.fn.selectpicker){return $(".selectpicker").selectpicker({iconBase:"fa"})}}});$.nette.ext("datagrid.groupActionMultiSelect",{success:function(){if($.fn.selectpicker){return datagridGroupActionMultiSelect()}}});$.nette.ext("datagrid.inline-editing",{success:function(a){if(a._datagrid_inline_editing){return $(".datagrid-inline-edit-trigger").addClass("hidden")}}});$.nette.ext("datagrid.redraw-item",{success:function(a){var b;if(a._datagrid_redraw_item_class){b=$("tr[data-id="+a._datagrid_redraw_item_id+"]");return b.attr("class",a._datagrid_redraw_item_class)}}});$.nette.ext("datagrid.reset-filter-by-column",{success:function(g){var e,b,d,c,a,f;if(!g._datagrid_name){return}e=$(".datagrid-"+g._datagrid_name);e.find("[data-datagrid-reset-filter-by-column]").addClass("hidden");if(g.non_empty_filters&&g.non_empty_filters.length){f=g.non_empty_filters;for(d=0,a=f.length;d<a;d++){c=f[d];e.find("[data-datagrid-reset-filter-by-column="+c+"]").removeClass("hidden")}b=e.find(".reset-filter").attr("href");return e.find("[data-datagrid-reset-filter-by-column]").each(function(){var h;c=$(this).attr("data-datagrid-reset-filter-by-column");h=b.replace("do="+g._datagrid_name+"-resetFilter","do="+g._datagrid_name+"-resetColumnFilter");h+="&"+g._datagrid_name+"-key="+c;return $(this).attr("href",h)})}}});